"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var app = getApp();
Page({
    data: {
        bgmList: [],
        serverUrl: app.serverUrl,
        videoParams: {
            duration: '',
            tempHeight: 0,
            tempWidth: 0,
            tempFilePath: '',
            tempConverPath: ''
        }
    },
    onLoad: function (params) {
        var _this = this;
        console.log('videoParams', params);
        _this.setData({
            videoParams: params
        });
        wx.showLoading({
            title: '获取BGM...'
        });
        wx.request({
            url: app.serverUrl + "/bgm/list",
            method: 'GET',
            header: {
                'Content-type': 'application/json'
            },
            success: function (res) {
                wx.hideLoading();
                if (res.data.status === 200) {
                    _this.setData({
                        bgmList: res.data.data
                    });
                }
            }
        });
    },
    uploadVideo: function (e) {
        var _this = this;
        var bgmId = e.detail.value.bgmId;
        var desc = e.detail.value.desc;
        var duration = _this.data.videoParams.duration || '0';
        var tmpHeight = _this.data.videoParams.tempHeight || 0;
        var tempWidth = _this.data.videoParams.tempWidth || 0;
        var tempVideoPath = _this.data.videoParams.tempFilePath || '';
        wx.showLoading({
            title: '上传中...'
        });
        wx.uploadFile({
            url: app.serverUrl + "/video/upload",
            formData: {
                userId: app.userInfo.id,
                bgmId: bgmId,
                videoSeconds: duration,
                videoWidth: tempWidth,
                videoHeight: tmpHeight,
                desc: desc,
            },
            filePath: tempVideoPath,
            name: 'file',
            header: {
                'Content-type': 'application/json'
            },
            success: function (res) {
                wx.hideLoading();
                var data = JSON.parse(res.data);
                console.log('upload video :', data);
                if (data.status === 200) {
                    wx.navigateBack({
                        delta: 1
                    });
                    wx.showToast({
                        title: '上传成功~',
                        icon: 'success',
                        duration: 1000
                    });
                }
                else {
                    wx.showToast({
                        title: '上传失败~'
                    });
                }
            }
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmdtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYmdtLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBR0EsSUFBTSxHQUFHLEdBQUcsTUFBTSxFQUFVLENBQUE7QUFlNUIsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFhO1FBQ2YsT0FBTyxFQUFDLEVBQUU7UUFDVixTQUFTLEVBQUUsR0FBRyxDQUFDLFNBQVM7UUFDeEIsV0FBVyxFQUFFO1lBQ1gsUUFBUSxFQUFFLEVBQUU7WUFDWixVQUFVLEVBQUUsQ0FBQztZQUNiLFNBQVMsRUFBRSxDQUFDO1lBQ1osWUFBWSxFQUFFLEVBQUU7WUFDaEIsY0FBYyxFQUFFLEVBQUU7U0FDbkI7S0FDRjtJQUNELE1BQU0sWUFBQyxNQUFXO1FBQ2hCLElBQU0sS0FBSyxHQUFHLElBQUksQ0FBQTtRQUNsQixPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxNQUFNLENBQUMsQ0FBQTtRQUNsQyxLQUFLLENBQUMsT0FBUSxDQUFDO1lBQ2IsV0FBVyxFQUFFLE1BQU07U0FDcEIsQ0FBQyxDQUFBO1FBRUYsRUFBRSxDQUFDLFdBQVcsQ0FBQztZQUNiLEtBQUssRUFBRSxVQUFVO1NBQ2xCLENBQUMsQ0FBQTtRQUNGLEVBQUUsQ0FBQyxPQUFPLENBQUM7WUFDVCxHQUFHLEVBQUUsR0FBRyxDQUFDLFNBQVMsR0FBRyxXQUFXO1lBQ2hDLE1BQU0sRUFBRSxLQUFLO1lBQ2IsTUFBTSxFQUFFO2dCQUNOLGNBQWMsRUFBRSxrQkFBa0I7YUFDbkM7WUFDRCxPQUFPLEVBQVAsVUFBUSxHQUFRO2dCQUNkLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtnQkFDaEIsSUFBRyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sS0FBSyxHQUFHLEVBQUU7b0JBQzFCLEtBQUssQ0FBQyxPQUFRLENBQUM7d0JBQ2IsT0FBTyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSTtxQkFDdkIsQ0FBQyxDQUFBO2lCQUNIO1lBQ0gsQ0FBQztTQUNGLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxXQUFXLFlBQUMsQ0FBTTtRQUNoQixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUE7UUFDbEIsSUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFBO1FBQ2xDLElBQU0sSUFBSSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQTtRQUVoQyxJQUFNLFFBQVEsR0FBVyxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFBO1FBQy9ELElBQU0sU0FBUyxHQUFXLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsSUFBSSxDQUFDLENBQUE7UUFDaEUsSUFBTSxTQUFTLEdBQVcsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxJQUFJLENBQUMsQ0FBQTtRQUMvRCxJQUFNLGFBQWEsR0FBVyxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxZQUFZLElBQUksRUFBRSxDQUFBO1FBS3ZFLEVBQUUsQ0FBQyxXQUFXLENBQUM7WUFDVCxLQUFLLEVBQUUsUUFBUTtTQUNwQixDQUFDLENBQUE7UUFDRixFQUFFLENBQUMsVUFBVSxDQUFDO1lBQ1osR0FBRyxFQUFFLEdBQUcsQ0FBQyxTQUFTLEdBQUcsZUFBZTtZQUNwQyxRQUFRLEVBQUM7Z0JBQ1AsTUFBTSxFQUFFLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRTtnQkFDdkIsS0FBSyxFQUFFLEtBQUs7Z0JBQ1osWUFBWSxFQUFFLFFBQVE7Z0JBQ3RCLFVBQVUsRUFBRSxTQUFTO2dCQUNyQixXQUFXLEVBQUUsU0FBUztnQkFDdEIsSUFBSSxFQUFFLElBQUk7YUFDWDtZQUNELFFBQVEsRUFBRSxhQUFhO1lBQ3ZCLElBQUksRUFBRSxNQUFNO1lBQ1osTUFBTSxFQUFFO2dCQUNOLGNBQWMsRUFBRSxrQkFBa0I7YUFDbkM7WUFDRCxPQUFPLFlBQUMsR0FBUTtnQkFDZCxFQUFFLENBQUMsV0FBVyxFQUFFLENBQUE7Z0JBRWhCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUVqQyxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxDQUFBO2dCQUNuQyxJQUFHLElBQUksQ0FBQyxNQUFNLEtBQUssR0FBRyxFQUFFO29CQXNDdEIsRUFBRSxDQUFDLFlBQVksQ0FBQzt3QkFDZCxLQUFLLEVBQUUsQ0FBQztxQkFDVCxDQUFDLENBQUE7b0JBQ0YsRUFBRSxDQUFDLFNBQVMsQ0FBQzt3QkFDWCxLQUFLLEVBQUUsT0FBTzt3QkFDZCxJQUFJLEVBQUUsU0FBUzt3QkFDZixRQUFRLEVBQUUsSUFBSTtxQkFDZixDQUFDLENBQUE7aUJBQ0g7cUJBQU07b0JBQ0wsRUFBRSxDQUFDLFNBQVMsQ0FBQzt3QkFDWCxLQUFLLEVBQUUsT0FBTztxQkFDZixDQUFDLENBQUE7aUJBQ0g7WUFDSCxDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBQ0osQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8v6I635Y+W5bqU55So5a6e5L6LXG5pbXBvcnQgeyBJTXlBcHAgfSBmcm9tICcuLi8uLi9hcHAnXG5cbmNvbnN0IGFwcCA9IGdldEFwcDxJTXlBcHA+KClcblxuaW50ZXJmYWNlIERhdGFQcm9wIHtcbiAgYmdtTGlzdDogQXJyYXk8T2JqZWN0PlxuICBzZXJ2ZXJVcmw/OiBzdHJpbmdcbiAgdmlkZW9QYXJhbXM6IHtcbiAgICBkdXJhdGlvbjogc3RyaW5nXG4gICAgdGVtcEhlaWdodD86IG51bWJlclxuICAgIHRlbXBXaWR0aD86IG51bWJlclxuICAgIHRlbXBGaWxlUGF0aDogc3RyaW5nXG4gICAgdGVtcENvbnZlclBhdGg/OiBzdHJpbmdcbiAgfVxufVxuXG5cblBhZ2Uoe1xuICBkYXRhOiA8RGF0YVByb3A+IHtcbiAgICBiZ21MaXN0OltdLFxuICAgIHNlcnZlclVybDogYXBwLnNlcnZlclVybCxcbiAgICB2aWRlb1BhcmFtczoge1xuICAgICAgZHVyYXRpb246ICcnLFxuICAgICAgdGVtcEhlaWdodDogMCxcbiAgICAgIHRlbXBXaWR0aDogMCxcbiAgICAgIHRlbXBGaWxlUGF0aDogJycsXG4gICAgICB0ZW1wQ29udmVyUGF0aDogJydcbiAgICB9XG4gIH0sXG4gIG9uTG9hZChwYXJhbXM6IGFueSl7XG4gICAgY29uc3QgX3RoaXMgPSB0aGlzXG4gICAgY29uc29sZS5sb2coJ3ZpZGVvUGFyYW1zJywgcGFyYW1zKVxuICAgIF90aGlzLnNldERhdGEhKHtcbiAgICAgIHZpZGVvUGFyYW1zOiBwYXJhbXNcbiAgICB9KVxuICAgIC8vIOiOt+WPlmJnbUxpc3RcbiAgICB3eC5zaG93TG9hZGluZyh7XG4gICAgICB0aXRsZTogJ+iOt+WPlkJHTS4uLidcbiAgICB9KVxuICAgIHd4LnJlcXVlc3Qoe1xuICAgICAgdXJsOiBhcHAuc2VydmVyVXJsICsgXCIvYmdtL2xpc3RcIixcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXI6IHtcbiAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfSxcbiAgICAgIHN1Y2Nlc3MocmVzOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgd3guaGlkZUxvYWRpbmcoKVxuICAgICAgICBpZihyZXMuZGF0YS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgIF90aGlzLnNldERhdGEhKHtcbiAgICAgICAgICAgIGJnbUxpc3Q6IHJlcy5kYXRhLmRhdGFcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgdXBsb2FkVmlkZW8oZTogYW55KSB7XG4gICAgY29uc3QgX3RoaXMgPSB0aGlzXG4gICAgY29uc3QgYmdtSWQgPSBlLmRldGFpbC52YWx1ZS5iZ21JZFxuICAgIGNvbnN0IGRlc2MgPSBlLmRldGFpbC52YWx1ZS5kZXNjXG5cbiAgICBjb25zdCBkdXJhdGlvbjogc3RyaW5nID0gX3RoaXMuZGF0YS52aWRlb1BhcmFtcy5kdXJhdGlvbiB8fCAnMCdcbiAgICBjb25zdCB0bXBIZWlnaHQ6IG51bWJlciA9IF90aGlzLmRhdGEudmlkZW9QYXJhbXMudGVtcEhlaWdodCB8fCAwXG4gICAgY29uc3QgdGVtcFdpZHRoOiBudW1iZXIgPSBfdGhpcy5kYXRhLnZpZGVvUGFyYW1zLnRlbXBXaWR0aCB8fCAwXG4gICAgY29uc3QgdGVtcFZpZGVvUGF0aDogc3RyaW5nID0gX3RoaXMuZGF0YS52aWRlb1BhcmFtcy50ZW1wRmlsZVBhdGggfHwgJydcbiAgICAvLyDlvq7kv6Hov5Tlm57nmoTlsIHpnaLlm77niYfmmK/kuIDkuKrmlofku7bvvIzmiYDku6XpnIDopoHlho3mrKHkuIrkvKDvvIjmiYvmnLrlsI/nqIvluo/kuI3kvJrov5Tlm57or6Xlj4LmlbDvvIlcbiAgICAvLyBjb25zdCB0ZW1wQ29udmVyRmlsZVBhdGg6IHN0cmluZyA9IF90aGlzLmRhdGEudmlkZW9QYXJhbXMudGVtcENvbnZlclBhdGggfHwgJydcblxuICAgIC8vIOS4iuS8oOinhumikVxuICAgIHd4LnNob3dMb2FkaW5nKHtcbiAgICAgICAgICB0aXRsZTogJ+S4iuS8oOS4rS4uLidcbiAgICB9KVxuICAgIHd4LnVwbG9hZEZpbGUoe1xuICAgICAgdXJsOiBhcHAuc2VydmVyVXJsICsgXCIvdmlkZW8vdXBsb2FkXCIsXG4gICAgICBmb3JtRGF0YTp7XG4gICAgICAgIHVzZXJJZDogYXBwLnVzZXJJbmZvLmlkLFxuICAgICAgICBiZ21JZDogYmdtSWQsXG4gICAgICAgIHZpZGVvU2Vjb25kczogZHVyYXRpb24sXG4gICAgICAgIHZpZGVvV2lkdGg6IHRlbXBXaWR0aCxcbiAgICAgICAgdmlkZW9IZWlnaHQ6IHRtcEhlaWdodCxcbiAgICAgICAgZGVzYzogZGVzYyxcbiAgICAgIH0sXG4gICAgICBmaWxlUGF0aDogdGVtcFZpZGVvUGF0aCxcbiAgICAgIG5hbWU6ICdmaWxlJyxcbiAgICAgIGhlYWRlcjoge1xuICAgICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICB9LFxuICAgICAgc3VjY2VzcyhyZXM6IGFueSkge1xuICAgICAgICB3eC5oaWRlTG9hZGluZygpXG4gICAgICAgIC8vIHVwbG9hZEZpbGUgQVBJIOi/lOWbnueahHJlcy5kYXRh5pivU3RyaW5n57G75Z6L77yM5omA5Lul6ZyA6KaB5L2/55So6L2s5o2i5Li6anNvbuexu+Wei1xuICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShyZXMuZGF0YSlcbiAgICAgICAgLy9kbyBzb21ldGhpbmdcbiAgICAgICAgY29uc29sZS5sb2coJ3VwbG9hZCB2aWRlbyA6JywgZGF0YSlcbiAgICAgICAgaWYoZGF0YS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgIFxuICAgICAgICAgIFxuICAgICAgICAgIC8vIOS4iuS8oOWwgemdouWbvueJh+aWh+S7tlxuICAgICAgICAgIC8vIGNvbnN0IHZpZGVvSWQgPSBkYXRhLmRhdGFcbiAgICAgICAgICAvLyDmiYvmnLrkuIrkuI3kvJrov5Tlm57lsIHpnaLlm77kuLTml7bot6/lvoRcbiAgICAgICAgICAvLyB3eC51cGxvYWRGaWxlKHtcbiAgICAgICAgICAvLyAgIHVybDogYXBwLnNlcnZlclVybCArIFwiL3ZpZGVvL3VwbG9hZENvdmVyXCIsXG4gICAgICAgICAgLy8gICBmb3JtRGF0YTp7XG4gICAgICAgICAgLy8gICAgIHVzZXJJZDogYXBwLnVzZXJJbmZvLmlkLFxuICAgICAgICAgIC8vICAgICB2aWRlb0lkOiB2aWRlb0lkXG4gICAgICAgICAgLy8gICB9LFxuICAgICAgICAgIC8vICAgZmlsZVBhdGg6IHRlbXBDb252ZXJGaWxlUGF0aCxcbiAgICAgICAgICAvLyAgIG5hbWU6ICdmaWxlJyxcbiAgICAgICAgICAvLyAgIGhlYWRlcjoge1xuICAgICAgICAgIC8vICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgLy8gICB9LFxuICAgICAgICAgIC8vICAgc3VjY2VzcyhyZXM6IGFueSkge1xuICAgICAgICAgIC8vICAgICB3eC5oaWRlTG9hZGluZygpXG4gICAgICAgICAgLy8gICAgIC8vIHVwbG9hZEZpbGUgQVBJIOi/lOWbnueahHJlcy5kYXRh5pivU3RyaW5n57G75Z6L77yM5omA5Lul6ZyA6KaB5L2/55So6L2s5o2i5Li6anNvbuexu+Wei1xuICAgICAgICAgIC8vICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShyZXMuZGF0YSlcbiAgICAgICAgICAvLyAgICAgLy9kbyBzb21ldGhpbmdcbiAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ3VwbG9hZCBjb3ZlciBmaWxlICA6JywgcmVzKVxuICAgICAgICAgIC8vICAgICBpZihkYXRhLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgLy8gICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgICAvLyAgICAgICAgIHRpdGxlOiAn5LiK5Lyg5oiQ5YqfficsXG4gICAgICAgICAgLy8gICAgICAgICBpY29uOiAnc3VjY2VzcycsXG4gICAgICAgICAgLy8gICAgICAgICBkdXJhdGlvbjogMTAwMFxuICAgICAgICAgIC8vICAgICAgIH0pICAgXG4gICAgICAgICAgLy8gICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gICAgICAgd3guc2hvd1RvYXN0KHtcbiAgICAgICAgICAvLyAgICAgICAgIHRpdGxlOiAn5LiK5Lyg5aSx6LSlfidcbiAgICAgICAgICAvLyAgICAgICB9KVxuICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgLy8gICB9XG4gICAgICAgICAgLy8gfSlcblxuICAgICAgICAgIC8v6L+U5Zue5LiK5LiA57qn6aG16Z2iXG4gICAgICAgICAgd3gubmF2aWdhdGVCYWNrKHtcbiAgICAgICAgICAgIGRlbHRhOiAxXG4gICAgICAgICAgfSlcbiAgICAgICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICAgICAgdGl0bGU6ICfkuIrkvKDmiJDlip9+JyxcbiAgICAgICAgICAgIGljb246ICdzdWNjZXNzJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwXG4gICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICAgICAgdGl0bGU6ICfkuIrkvKDlpLHotKV+J1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICB9XG59KSJdfQ==